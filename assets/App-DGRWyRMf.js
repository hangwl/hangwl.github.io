const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/factory-H13x5T5m.js","assets/index-DfB3xycO.js","assets/index-CWGEdT4S.css","assets/index-Chjiymov.js","assets/plotly.min-Cir5TFAJ.js"])))=>i.map(i=>d[i]);
import{j as h,a as re,r as z,_ as Y,w as ne,B as K}from"./index-DfB3xycO.js";function Z({className:k,type:E,...N}){return h.jsx("input",{type:E,"data-slot":"input",className:re("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",k),...N})}const ie=z.lazy(async()=>{const[{default:k},E]=await Promise.all([Y(()=>import("./factory-H13x5T5m.js").then(s=>s.f),__vite__mapDeps([0,1,2,3])),Y(()=>import("./plotly.min-Cir5TFAJ.js").then(s=>s.p),__vite__mapDeps([4,1,2]))]);return{default:k(E.default??E)}});function j(k){return h.jsx(z.Suspense,{fallback:h.jsx("div",{className:"h-72 w-full rounded-lg bg-muted animate-pulse"}),children:h.jsx(ie,{...k})})}var D={exports:{}},oe=D.exports,X;function se(){return X||(X=1,function(k,E){(function(N,s){k.exports=s()})(oe,function(){var N=function(s,u){var w=Array.prototype.concat,g=Array.prototype.slice,x=Object.prototype.toString;function v(d,c){var a=d>c?d:c;return s.pow(10,17-~~(s.log(a>0?a:-a)*s.LOG10E))}var o=Array.isArray||function(c){return x.call(c)==="[object Array]"};function e(d){return x.call(d)==="[object Function]"}function r(d){return typeof d=="number"?d-d===0:!1}function n(d){return w.apply([],d)}function i(){return new i._init(arguments)}i.fn=i.prototype,i._init=function(c){if(o(c[0]))if(o(c[0][0])){e(c[1])&&(c[0]=i.map(c[0],c[1]));for(var a=0;a<c[0].length;a++)this[a]=c[0][a];this.length=c[0].length}else this[0]=e(c[1])?i.map(c[0],c[1]):c[0],this.length=1;else if(r(c[0]))this[0]=i.seq.apply(null,c),this.length=1;else{if(c[0]instanceof i)return i(c[0].toArray());this[0]=[],this.length=1}return this},i._init.prototype=i.prototype,i._init.constructor=i,i.utils={calcRdx:v,isArray:o,isFunction:e,isNumber:r,toVector:n},i._random_fn=s.random,i.setRandom=function(c){if(typeof c!="function")throw new TypeError("fn is not a function");i._random_fn=c},i.extend=function(c){var a,p;if(arguments.length===1){for(p in c)i[p]=c[p];return this}for(a=1;a<arguments.length;a++)for(p in arguments[a])c[p]=arguments[a][p];return c},i.rows=function(c){return c.length||1},i.cols=function(c){return c[0].length||1},i.dimensions=function(c){return{rows:i.rows(c),cols:i.cols(c)}},i.row=function(c,a){return o(a)?a.map(function(p){return i.row(c,p)}):c[a]},i.rowa=function(c,a){return i.row(c,a)},i.col=function(c,a){if(o(a)){var p=i.arange(c.length).map(function(){return new Array(a.length)});return a.forEach(function(q,R){i.arange(c.length).forEach(function(_){p[_][R]=c[_][q]})}),p}for(var y=new Array(c.length),b=0;b<c.length;b++)y[b]=[c[b][a]];return y},i.cola=function(c,a){return i.col(c,a).map(function(p){return p[0]})},i.diag=function(c){for(var a=i.rows(c),p=new Array(a),y=0;y<a;y++)p[y]=[c[y][y]];return p},i.antidiag=function(c){for(var a=i.rows(c)-1,p=new Array(a),y=0;a>=0;a--,y++)p[y]=[c[y][a]];return p},i.transpose=function(c){var a=[],p,y,b,q,R;for(o(c[0])||(c=[c]),y=c.length,b=c[0].length,R=0;R<b;R++){for(p=new Array(y),q=0;q<y;q++)p[q]=c[q][R];a.push(p)}return a.length===1?a[0]:a},i.map=function(c,a,p){var y,b,q,R,_;for(o(c[0])||(c=[c]),b=c.length,q=c[0].length,R=p?c:new Array(b),y=0;y<b;y++)for(R[y]||(R[y]=new Array(q)),_=0;_<q;_++)R[y][_]=a(c[y][_],y,_);return R.length===1?R[0]:R},i.cumreduce=function(c,a,p){var y,b,q,R,_;for(o(c[0])||(c=[c]),b=c.length,q=c[0].length,R=p?c:new Array(b),y=0;y<b;y++)for(R[y]||(R[y]=new Array(q)),q>0&&(R[y][0]=c[y][0]),_=1;_<q;_++)R[y][_]=a(R[y][_-1],c[y][_]);return R.length===1?R[0]:R},i.alter=function(c,a){return i.map(c,a,!0)},i.create=function(c,a,p){var y=new Array(c),b,q;for(e(a)&&(p=a,a=c),b=0;b<c;b++)for(y[b]=new Array(a),q=0;q<a;q++)y[b][q]=p(b,q);return y};function t(){return 0}i.zeros=function(c,a){return r(a)||(a=c),i.create(c,a,t)};function l(){return 1}i.ones=function(c,a){return r(a)||(a=c),i.create(c,a,l)},i.rand=function(c,a){return r(a)||(a=c),i.create(c,a,i._random_fn)};function f(d,c){return d===c?1:0}i.identity=function(c,a){return r(a)||(a=c),i.create(c,a,f)},i.symmetric=function(c){var a=c.length,p,y;if(c.length!==c[0].length)return!1;for(p=0;p<a;p++)for(y=0;y<a;y++)if(c[y][p]!==c[p][y])return!1;return!0},i.clear=function(c){return i.alter(c,t)},i.seq=function(c,a,p,y){e(y)||(y=!1);var b=[],q=v(c,a),R=(a*q-c*q)/((p-1)*q),_=c,P;for(P=0;_<=a&&P<p;P++,_=(c*q+R*q*P)/q)b.push(y?y(_,P):_);return b},i.arange=function(c,a,p){var y=[],b;if(p=p||1,a===u&&(a=c,c=0),c===a||p===0)return[];if(c<a&&p<0)return[];if(c>a&&p>0)return[];if(p>0)for(b=c;b<a;b+=p)y.push(b);else for(b=c;b>a;b+=p)y.push(b);return y},i.slice=function(){function d(a,p,y,b){var q,R=[],_=a.length;if(p===u&&y===u&&b===u)return i.copy(a);if(p=p||0,y=y||a.length,p=p>=0?p:_+p,y=y>=0?y:_+y,b=b||1,p===y||b===0)return[];if(p<y&&b<0)return[];if(p>y&&b>0)return[];if(b>0)for(q=p;q<y;q+=b)R.push(a[q]);else for(q=p;q>y;q+=b)R.push(a[q]);return R}function c(a,p){var y,b;if(p=p||{},r(p.row)){if(r(p.col))return a[p.row][p.col];var q=i.rowa(a,p.row);return y=p.col||{},d(q,y.start,y.end,y.step)}if(r(p.col)){var R=i.cola(a,p.col);return b=p.row||{},d(R,b.start,b.end,b.step)}b=p.row||{},y=p.col||{};var _=d(a,b.start,b.end,b.step);return _.map(function(P){return d(P,y.start,y.end,y.step)})}return c}(),i.sliceAssign=function(c,a,p){var y,b;if(r(a.row)){if(r(a.col))return c[a.row][a.col]=p;a.col=a.col||{},a.col.start=a.col.start||0,a.col.end=a.col.end||c[0].length,a.col.step=a.col.step||1,y=i.arange(a.col.start,s.min(c.length,a.col.end),a.col.step);var q=a.row;return y.forEach(function(_,P){c[q][_]=p[P]}),c}if(r(a.col)){a.row=a.row||{},a.row.start=a.row.start||0,a.row.end=a.row.end||c.length,a.row.step=a.row.step||1,b=i.arange(a.row.start,s.min(c[0].length,a.row.end),a.row.step);var R=a.col;return b.forEach(function(_,P){c[_][R]=p[P]}),c}return p[0].length===u&&(p=[p]),a.row.start=a.row.start||0,a.row.end=a.row.end||c.length,a.row.step=a.row.step||1,a.col.start=a.col.start||0,a.col.end=a.col.end||c[0].length,a.col.step=a.col.step||1,b=i.arange(a.row.start,s.min(c.length,a.row.end),a.row.step),y=i.arange(a.col.start,s.min(c[0].length,a.col.end),a.col.step),b.forEach(function(_,P){y.forEach(function(I,A){c[_][I]=p[P][A]})}),c},i.diagonal=function(c){var a=i.zeros(c.length,c.length);return c.forEach(function(p,y){a[y][y]=p}),a},i.copy=function(c){return c.map(function(a){return r(a)?a:a.map(function(p){return p})})};var m=i.prototype;return m.length=0,m.push=Array.prototype.push,m.sort=Array.prototype.sort,m.splice=Array.prototype.splice,m.slice=Array.prototype.slice,m.toArray=function(){return this.length>1?g.call(this):g.call(this)[0]},m.map=function(c,a){return i(i.map(this,c,a))},m.cumreduce=function(c,a){return i(i.cumreduce(this,c,a))},m.alter=function(c){return i.alter(this,c),this},function(d){for(var c=0;c<d.length;c++)(function(a){m[a]=function(p){var y=this,b;return p?(setTimeout(function(){p.call(y,m[a].call(y))}),this):(b=i[a](this),o(b)?i(b):b)}})(d[c])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(d){for(var c=0;c<d.length;c++)(function(a){m[a]=function(p,y){var b=this;return y?(setTimeout(function(){y.call(b,m[a].call(b,p))}),this):i(i[a](this,p))}})(d[c])}("row col".split(" ")),function(d){for(var c=0;c<d.length;c++)(function(a){m[a]=function(){return i(i[a].apply(null,arguments))}})(d[c])}("create zeros ones rand identity".split(" ")),i}(Math);return function(s,u){var w=s.utils.isFunction;function g(o,e){return o-e}function x(o,e,r){return u.max(e,u.min(o,r))}s.sum=function(e){for(var r=0,n=e.length;--n>=0;)r+=e[n];return r},s.sumsqrd=function(e){for(var r=0,n=e.length;--n>=0;)r+=e[n]*e[n];return r},s.sumsqerr=function(e){for(var r=s.mean(e),n=0,i=e.length,t;--i>=0;)t=e[i]-r,n+=t*t;return n},s.sumrow=function(e){for(var r=0,n=e.length;--n>=0;)r+=e[n];return r},s.product=function(e){for(var r=1,n=e.length;--n>=0;)r*=e[n];return r},s.min=function(e){for(var r=e[0],n=0;++n<e.length;)e[n]<r&&(r=e[n]);return r},s.max=function(e){for(var r=e[0],n=0;++n<e.length;)e[n]>r&&(r=e[n]);return r},s.unique=function(e){for(var r={},n=[],i=0;i<e.length;i++)r[e[i]]||(r[e[i]]=!0,n.push(e[i]));return n},s.mean=function(e){return s.sum(e)/e.length},s.meansqerr=function(e){return s.sumsqerr(e)/e.length},s.geomean=function(e){var r=e.map(u.log),n=s.mean(r);return u.exp(n)},s.median=function(e){var r=e.length,n=e.slice().sort(g);return r&1?n[r/2|0]:(n[r/2-1]+n[r/2])/2},s.cumsum=function(e){return s.cumreduce(e,function(r,n){return r+n})},s.cumprod=function(e){return s.cumreduce(e,function(r,n){return r*n})},s.diff=function(e){var r=[],n=e.length,i;for(i=1;i<n;i++)r.push(e[i]-e[i-1]);return r},s.rank=function(o){var e,r=[],n={};for(e=0;e<o.length;e++){var i=o[e];n[i]?n[i]++:(n[i]=1,r.push(i))}var t=r.sort(g),l={},f=1;for(e=0;e<t.length;e++){var i=t[e],m=n[i],d=f,c=f+m-1,a=(d+c)/2;l[i]=a,f+=m}return o.map(function(p){return l[p]})},s.mode=function(e){var r=e.length,n=e.slice().sort(g),i=1,t=0,l=0,f=[],m;for(m=0;m<r;m++)n[m]===n[m+1]?i++:(i>t?(f=[n[m]],t=i,l=0):i===t&&(f.push(n[m]),l++),i=1);return l===0?f[0]:f},s.range=function(e){return s.max(e)-s.min(e)},s.variance=function(e,r){return s.sumsqerr(e)/(e.length-(r?1:0))},s.pooledvariance=function(e){var r=e.reduce(function(i,t){return i+s.sumsqerr(t)},0),n=e.reduce(function(i,t){return i+t.length},0);return r/(n-e.length)},s.deviation=function(o){for(var e=s.mean(o),r=o.length,n=new Array(r),i=0;i<r;i++)n[i]=o[i]-e;return n},s.stdev=function(e,r){return u.sqrt(s.variance(e,r))},s.pooledstdev=function(e){return u.sqrt(s.pooledvariance(e))},s.meandev=function(e){for(var r=s.mean(e),n=[],i=e.length-1;i>=0;i--)n.push(u.abs(e[i]-r));return s.mean(n)},s.meddev=function(e){for(var r=s.median(e),n=[],i=e.length-1;i>=0;i--)n.push(u.abs(e[i]-r));return s.median(n)},s.coeffvar=function(e){return s.stdev(e)/s.mean(e)},s.quartiles=function(e){var r=e.length,n=e.slice().sort(g);return[n[u.round(r/4)-1],n[u.round(r/2)-1],n[u.round(r*3/4)-1]]},s.quantiles=function(e,r,n,i){var t=e.slice().sort(g),l=[r.length],f=e.length,m,d,c,a,p,y;for(typeof n>"u"&&(n=3/8),typeof i>"u"&&(i=3/8),m=0;m<r.length;m++)d=r[m],c=n+d*(1-n-i),a=f*d+c,p=u.floor(x(a,1,f-1)),y=x(a-p,0,1),l[m]=(1-y)*t[p-1]+y*t[p];return l},s.percentile=function(e,r,n){var i=e.slice().sort(g),t=r*(i.length+(n?1:-1))+(n?0:1),l=parseInt(t),f=t-l;return l+1<i.length?i[l-1]+f*(i[l]-i[l-1]):i[l-1]},s.percentileOfScore=function(e,r,n){var i=0,t=e.length,l=!1,f,m;for(n==="strict"&&(l=!0),m=0;m<t;m++)f=e[m],(l&&f<r||!l&&f<=r)&&i++;return i/t},s.histogram=function(e,r){r=r||4;var n=s.min(e),i=(s.max(e)-n)/r,t=e.length,l=[],f;for(f=0;f<r;f++)l[f]=0;for(f=0;f<t;f++)l[u.min(u.floor((e[f]-n)/i),r-1)]+=1;return l},s.covariance=function(e,r){var n=s.mean(e),i=s.mean(r),t=e.length,l=new Array(t),f;for(f=0;f<t;f++)l[f]=(e[f]-n)*(r[f]-i);return s.sum(l)/(t-1)},s.corrcoeff=function(e,r){return s.covariance(e,r)/s.stdev(e,1)/s.stdev(r,1)},s.spearmancoeff=function(o,e){return o=s.rank(o),e=s.rank(e),s.corrcoeff(o,e)},s.stanMoment=function(e,r){for(var n=s.mean(e),i=s.stdev(e),t=e.length,l=0,f=0;f<t;f++)l+=u.pow((e[f]-n)/i,r);return l/e.length},s.skewness=function(e){return s.stanMoment(e,3)},s.kurtosis=function(e){return s.stanMoment(e,4)-3};var v=s.prototype;(function(o){for(var e=0;e<o.length;e++)(function(r){v[r]=function(n,i){var t=[],l=0,f=this;if(w(n)&&(i=n,n=!1),i)return setTimeout(function(){i.call(f,v[r].call(f,n))}),this;if(this.length>1){for(f=n===!0?this:this.transpose();l<f.length;l++)t[l]=s[r](f[l]);return t}return s[r](this[0],n)}})(o[e])})("cumsum cumprod".split(" ")),function(o){for(var e=0;e<o.length;e++)(function(r){v[r]=function(n,i){var t=[],l=0,f=this;if(w(n)&&(i=n,n=!1),i)return setTimeout(function(){i.call(f,v[r].call(f,n))}),this;if(this.length>1){for(r!=="sumrow"&&(f=n===!0?this:this.transpose());l<f.length;l++)t[l]=s[r](f[l]);return n===!0?s[r](s.utils.toVector(t)):t}return s[r](this[0],n)}})(o[e])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(o){for(var e=0;e<o.length;e++)(function(r){v[r]=function(){var n=[],i=0,t=this,l=Array.prototype.slice.call(arguments),f;if(w(l[l.length-1])){f=l[l.length-1];var m=l.slice(0,l.length-1);return setTimeout(function(){f.call(t,v[r].apply(t,m))}),this}else{f=void 0;var d=function(a){return s[r].apply(t,[a].concat(l))}}if(this.length>1){for(t=t.transpose();i<t.length;i++)n[i]=d(t[i]);return n}return d(this[0])}})(o[e])}("quantiles percentileOfScore".split(" "))}(N,Math),function(s,u){s.gammaln=function(g){var x=0,v=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],o=1.000000000190015,e,r,n;for(n=(r=e=g)+5.5,n-=(e+.5)*u.log(n);x<6;x++)o+=v[x]/++r;return u.log(2.5066282746310007*o/e)-n},s.loggam=function(g){var x,v,o,e,r,n,i,t=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(x=g,i=0,g==1||g==2)return 0;for(g<=7&&(i=u.floor(7-g),x=g+i),v=1/(x*x),o=2*u.PI,r=t[9],n=8;n>=0;n--)r*=v,r+=t[n];if(e=r/x+.5*u.log(o)+(x-.5)*u.log(x)-x,g<=7)for(n=1;n<=i;n++)e-=u.log(x-1),x-=1;return e},s.gammafn=function(g){var x=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],v=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],o=!1,e=0,r=0,n=0,i=g,t,l,f,m;if(g>171.6243769536076)return 1/0;if(i<=0)if(m=i%1+36e-17,m)o=(i&1?-1:1)*u.PI/u.sin(u.PI*m),i=1-i;else return 1/0;for(f=i,i<1?l=i++:l=(i-=e=(i|0)-1)-1,t=0;t<8;++t)n=(n+x[t])*l,r=r*l+v[t];if(m=n/r+1,f<i)m/=f;else if(f>i)for(t=0;t<e;++t)m*=i,i++;return o&&(m=o/m),m},s.gammap=function(g,x){return s.lowRegGamma(g,x)*s.gammafn(g)},s.lowRegGamma=function(g,x){var v=s.gammaln(g),o=g,e=1/g,r=e,n=x+1-g,i=1/1e-30,t=1/n,l=t,f=1,m=-~(u.log(g>=1?g:1/g)*8.5+g*.4+17),d;if(x<0||g<=0)return NaN;if(x<g+1){for(;f<=m;f++)e+=r*=x/++o;return e*u.exp(-x+g*u.log(x)-v)}for(;f<=m;f++)d=-f*(f-g),n+=2,t=d*t+n,i=n+d/i,t=1/t,l*=t*i;return 1-l*u.exp(-x+g*u.log(x)-v)},s.factorialln=function(g){return g<0?NaN:s.gammaln(g+1)},s.factorial=function(g){return g<0?NaN:s.gammafn(g+1)},s.combination=function(g,x){return g>170||x>170?u.exp(s.combinationln(g,x)):s.factorial(g)/s.factorial(x)/s.factorial(g-x)},s.combinationln=function(g,x){return s.factorialln(g)-s.factorialln(x)-s.factorialln(g-x)},s.permutation=function(g,x){return s.factorial(g)/s.factorial(g-x)},s.betafn=function(g,x){if(!(g<=0||x<=0))return g+x>170?u.exp(s.betaln(g,x)):s.gammafn(g)*s.gammafn(x)/s.gammafn(g+x)},s.betaln=function(g,x){return s.gammaln(g)+s.gammaln(x)-s.gammaln(g+x)},s.betacf=function(g,x,v){var o=1e-30,e=1,r=x+v,n=x+1,i=x-1,t=1,l=1-r*g/n,f,m,d,c;for(u.abs(l)<o&&(l=o),l=1/l,c=l;e<=100&&(f=2*e,m=e*(v-e)*g/((i+f)*(x+f)),l=1+m*l,u.abs(l)<o&&(l=o),t=1+m/t,u.abs(t)<o&&(t=o),l=1/l,c*=l*t,m=-(x+e)*(r+e)*g/((x+f)*(n+f)),l=1+m*l,u.abs(l)<o&&(l=o),t=1+m/t,u.abs(t)<o&&(t=o),l=1/l,d=l*t,c*=d,!(u.abs(d-1)<3e-7));e++);return c},s.gammapinv=function(g,x){var v=0,o=x-1,e=1e-8,r=s.gammaln(x),n,i,t,l,f,m,d;if(g>=1)return u.max(100,x+100*u.sqrt(x));if(g<=0)return 0;for(x>1?(m=u.log(o),d=u.exp(o*(m-1)-r),f=g<.5?g:1-g,t=u.sqrt(-2*u.log(f)),n=(2.30753+t*.27061)/(1+t*(.99229+t*.04481))-t,g<.5&&(n=-n),n=u.max(.001,x*u.pow(1-1/(9*x)-n/(3*u.sqrt(x)),3))):(t=1-x*(.253+x*.12),g<t?n=u.pow(g/t,1/x):n=1-u.log(1-(g-t)/(1-t)));v<12;v++){if(n<=0)return 0;if(i=s.lowRegGamma(x,n)-g,x>1?t=d*u.exp(-(n-o)+o*(u.log(n)-m)):t=u.exp(-n+o*u.log(n)-r),l=i/t,n-=t=l/(1-.5*u.min(1,l*((x-1)/n-1))),n<=0&&(n=.5*(n+t)),u.abs(t)<e*n)break}return n},s.erf=function(g){var x=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],v=x.length-1,o=!1,e=0,r=0,n,i,t,l;for(g<0&&(g=-g,o=!0),n=2/(2+g),i=4*n-2;v>0;v--)t=e,e=i*e-r+x[v],r=t;return l=n*u.exp(-g*g+.5*(x[0]+i*e)-r),o?l-1:1-l},s.erfc=function(g){return 1-s.erf(g)},s.erfcinv=function(g){var x=0,v,o,e,r;if(g>=2)return-100;if(g<=0)return 100;for(r=g<1?g:2-g,e=u.sqrt(-2*u.log(r/2)),v=-.70711*((2.30753+e*.27061)/(1+e*(.99229+e*.04481))-e);x<2;x++)o=s.erfc(v)-r,v+=o/(1.1283791670955126*u.exp(-v*v)-v*o);return g<1?v:-v},s.ibetainv=function(g,x,v){var o=1e-8,e=x-1,r=v-1,n=0,i,t,l,f,m,d,c,a,p,y,b;if(g<=0)return 0;if(g>=1)return 1;for(x>=1&&v>=1?(l=g<.5?g:1-g,f=u.sqrt(-2*u.log(l)),c=(2.30753+f*.27061)/(1+f*(.99229+f*.04481))-f,g<.5&&(c=-c),a=(c*c-3)/6,p=2/(1/(2*x-1)+1/(2*v-1)),y=c*u.sqrt(a+p)/p-(1/(2*v-1)-1/(2*x-1))*(a+5/6-2/(3*p)),c=x/(x+v*u.exp(2*y))):(i=u.log(x/(x+v)),t=u.log(v/(x+v)),f=u.exp(x*i)/x,m=u.exp(v*t)/v,y=f+m,g<f/y?c=u.pow(x*y*g,1/x):c=1-u.pow(v*y*(1-g),1/v)),b=-s.gammaln(x)-s.gammaln(v)+s.gammaln(x+v);n<10;n++){if(c===0||c===1)return c;if(d=s.ibeta(c,x,v)-g,f=u.exp(e*u.log(c)+r*u.log(1-c)+b),m=d/f,c-=f=m/(1-.5*u.min(1,m*(e/c-r/(1-c)))),c<=0&&(c=.5*(c+f)),c>=1&&(c=.5*(c+f+1)),u.abs(f)<o*c&&n>0)break}return c},s.ibeta=function(g,x,v){var o=g===0||g===1?0:u.exp(s.gammaln(x+v)-s.gammaln(x)-s.gammaln(v)+x*u.log(g)+v*u.log(1-g));return g<0||g>1?!1:g<(x+1)/(x+v+2)?o*s.betacf(g,x,v)/x:1-o*s.betacf(1-g,v,x)/v},s.randn=function(g,x){var v,o,e,r,n;if(x||(x=g),g)return s.create(g,x,function(){return s.randn()});do v=s._random_fn(),o=1.7156*(s._random_fn()-.5),e=v-.449871,r=u.abs(o)+.386595,n=e*e+r*(.196*r-.25472*e);while(n>.27597&&(n>.27846||o*o>-4*u.log(v)*v*v));return o/v},s.randg=function(g,x,v){var o=g,e,r,n,i,t,l;if(v||(v=x),g||(g=1),x)return l=s.zeros(x,v),l.alter(function(){return s.randg(g)}),l;g<1&&(g+=1),e=g-1/3,r=1/u.sqrt(9*e);do{do t=s.randn(),i=1+r*t;while(i<=0);i=i*i*i,n=s._random_fn()}while(n>1-.331*u.pow(t,4)&&u.log(n)>.5*t*t+e*(1-i+u.log(i)));if(g==o)return e*i;do n=s._random_fn();while(n===0);return u.pow(n,1/o)*e*i},function(w){for(var g=0;g<w.length;g++)(function(x){s.fn[x]=function(){return s(s.map(this,function(v){return s[x](v)}))}})(w[g])}("gammaln gammafn factorial factorialln".split(" ")),function(w){for(var g=0;g<w.length;g++)(function(x){s.fn[x]=function(){return s(s[x].apply(null,arguments))}})(w[g])}("randn".split(" "))}(N,Math),function(s,u){(function(o){for(var e=0;e<o.length;e++)(function(r){s[r]=function n(i,t,l){return this instanceof n?(this._a=i,this._b=t,this._c=l,this):new n(i,t,l)},s.fn[r]=function(n,i,t){var l=s[r](n,i,t);return l.data=this,l},s[r].prototype.sample=function(n){var i=this._a,t=this._b,l=this._c;return n?s.alter(n,function(){return s[r].sample(i,t,l)}):s[r].sample(i,t,l)},function(n){for(var i=0;i<n.length;i++)(function(t){s[r].prototype[t]=function(l){var f=this._a,m=this._b,d=this._c;return!l&&l!==0&&(l=this.data),typeof l!="number"?s.fn.map.call(l,function(c){return s[r][t](c,f,m,d)}):s[r][t](l,f,m,d)}})(n[i])}("pdf cdf inv".split(" ")),function(n){for(var i=0;i<n.length;i++)(function(t){s[r].prototype[t]=function(){return s[r][t](this._a,this._b,this._c)}})(n[i])}("mean median mode variance".split(" "))})(o[e])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),s.extend(s.beta,{pdf:function(e,r,n){return e>1||e<0?0:r==1&&n==1?1:r<512&&n<512?u.pow(e,r-1)*u.pow(1-e,n-1)/s.betafn(r,n):u.exp((r-1)*u.log(e)+(n-1)*u.log(1-e)-s.betaln(r,n))},cdf:function(e,r,n){return e>1||e<0?(e>1)*1:s.ibeta(e,r,n)},inv:function(e,r,n){return s.ibetainv(e,r,n)},mean:function(e,r){return e/(e+r)},median:function(e,r){return s.ibetainv(.5,e,r)},mode:function(e,r){return(e-1)/(e+r-2)},sample:function(e,r){var n=s.randg(e);return n/(n+s.randg(r))},variance:function(e,r){return e*r/(u.pow(e+r,2)*(e+r+1))}}),s.extend(s.centralF,{pdf:function(e,r,n){var i,t,l;return e<0?0:r<=2?e===0&&r<2?1/0:e===0&&r===2?1:1/s.betafn(r/2,n/2)*u.pow(r/n,r/2)*u.pow(e,r/2-1)*u.pow(1+r/n*e,-(r+n)/2):(i=r*e/(n+e*r),t=n/(n+e*r),l=r*t/2,l*s.binomial.pdf((r-2)/2,(r+n-2)/2,i))},cdf:function(e,r,n){return e<0?0:s.ibeta(r*e/(r*e+n),r/2,n/2)},inv:function(e,r,n){return n/(r*(1/s.ibetainv(e,r/2,n/2)-1))},mean:function(e,r){return r>2?r/(r-2):void 0},mode:function(e,r){return e>2?r*(e-2)/(e*(r+2)):void 0},sample:function(e,r){var n=s.randg(e/2)*2,i=s.randg(r/2)*2;return n/e/(i/r)},variance:function(e,r){if(!(r<=4))return 2*r*r*(e+r-2)/(e*(r-2)*(r-2)*(r-4))}}),s.extend(s.cauchy,{pdf:function(e,r,n){return n<0?0:n/(u.pow(e-r,2)+u.pow(n,2))/u.PI},cdf:function(e,r,n){return u.atan((e-r)/n)/u.PI+.5},inv:function(o,e,r){return e+r*u.tan(u.PI*(o-.5))},median:function(e){return e},mode:function(e){return e},sample:function(e,r){return s.randn()*u.sqrt(1/(2*s.randg(.5)))*r+e}}),s.extend(s.chisquare,{pdf:function(e,r){return e<0?0:e===0&&r===2?.5:u.exp((r/2-1)*u.log(e)-e/2-r/2*u.log(2)-s.gammaln(r/2))},cdf:function(e,r){return e<0?0:s.lowRegGamma(r/2,e/2)},inv:function(o,e){return 2*s.gammapinv(o,.5*e)},mean:function(o){return o},median:function(e){return e*u.pow(1-2/(9*e),3)},mode:function(e){return e-2>0?e-2:0},sample:function(e){return s.randg(e/2)*2},variance:function(e){return 2*e}}),s.extend(s.exponential,{pdf:function(e,r){return e<0?0:r*u.exp(-r*e)},cdf:function(e,r){return e<0?0:1-u.exp(-r*e)},inv:function(o,e){return-u.log(1-o)/e},mean:function(o){return 1/o},median:function(o){return 1/o*u.log(2)},mode:function(){return 0},sample:function(e){return-1/e*u.log(s._random_fn())},variance:function(o){return u.pow(o,-2)}}),s.extend(s.gamma,{pdf:function(e,r,n){return e<0?0:e===0&&r===1?1/n:u.exp((r-1)*u.log(e)-e/n-s.gammaln(r)-r*u.log(n))},cdf:function(e,r,n){return e<0?0:s.lowRegGamma(r,e/n)},inv:function(o,e,r){return s.gammapinv(o,e)*r},mean:function(o,e){return o*e},mode:function(e,r){if(e>1)return(e-1)*r},sample:function(e,r){return s.randg(e)*r},variance:function(e,r){return e*r*r}}),s.extend(s.invgamma,{pdf:function(e,r,n){return e<=0?0:u.exp(-(r+1)*u.log(e)-n/e-s.gammaln(r)+r*u.log(n))},cdf:function(e,r,n){return e<=0?0:1-s.lowRegGamma(r,n/e)},inv:function(o,e,r){return r/s.gammapinv(1-o,e)},mean:function(o,e){return o>1?e/(o-1):void 0},mode:function(e,r){return r/(e+1)},sample:function(e,r){return r/s.randg(e)},variance:function(e,r){if(!(e<=2))return r*r/((e-1)*(e-1)*(e-2))}}),s.extend(s.kumaraswamy,{pdf:function(e,r,n){return e===0&&r===1?n:e===1&&n===1?r:u.exp(u.log(r)+u.log(n)+(r-1)*u.log(e)+(n-1)*u.log(1-u.pow(e,r)))},cdf:function(e,r,n){return e<0?0:e>1?1:1-u.pow(1-u.pow(e,r),n)},inv:function(e,r,n){return u.pow(1-u.pow(1-e,1/n),1/r)},mean:function(o,e){return e*s.gammafn(1+1/o)*s.gammafn(e)/s.gammafn(1+1/o+e)},median:function(e,r){return u.pow(1-u.pow(2,-1/r),1/e)},mode:function(e,r){if(e>=1&&r>=1&&e!==1&&r!==1)return u.pow((e-1)/(e*r-1),1/e)},variance:function(){throw new Error("variance not yet implemented")}}),s.extend(s.lognormal,{pdf:function(e,r,n){return e<=0?0:u.exp(-u.log(e)-.5*u.log(2*u.PI)-u.log(n)-u.pow(u.log(e)-r,2)/(2*n*n))},cdf:function(e,r,n){return e<0?0:.5+.5*s.erf((u.log(e)-r)/u.sqrt(2*n*n))},inv:function(o,e,r){return u.exp(-1.4142135623730951*r*s.erfcinv(2*o)+e)},mean:function(e,r){return u.exp(e+r*r/2)},median:function(e){return u.exp(e)},mode:function(e,r){return u.exp(e-r*r)},sample:function(e,r){return u.exp(s.randn()*r+e)},variance:function(e,r){return(u.exp(r*r)-1)*u.exp(2*e+r*r)}}),s.extend(s.noncentralt,{pdf:function(e,r,n){var i=1e-14;return u.abs(n)<i?s.studentt.pdf(e,r):u.abs(e)<i?u.exp(s.gammaln((r+1)/2)-n*n/2-.5*u.log(u.PI*r)-s.gammaln(r/2)):r/e*(s.noncentralt.cdf(e*u.sqrt(1+2/r),r+2,n)-s.noncentralt.cdf(e,r,n))},cdf:function(e,r,n){var i=1e-14,t=200;if(u.abs(n)<i)return s.studentt.cdf(e,r);var l=!1;e<0&&(l=!0,n=-n);for(var f=s.normal.cdf(-n,0,1),m=i+1,d=m,c=e*e/(e*e+r),a=0,p=u.exp(-n*n/2),y=u.exp(-n*n/2-.5*u.log(2)-s.gammaln(3/2))*n;a<t||d>i||m>i;)d=m,a>0&&(p*=n*n/(2*a),y*=n*n/(2*(a+1/2))),m=p*s.beta.cdf(c,a+.5,r/2)+y*s.beta.cdf(c,a+1,r/2),f+=.5*m,a++;return l?1-f:f}}),s.extend(s.normal,{pdf:function(e,r,n){return u.exp(-.5*u.log(2*u.PI)-u.log(n)-u.pow(e-r,2)/(2*n*n))},cdf:function(e,r,n){return .5*(1+s.erf((e-r)/u.sqrt(2*n*n)))},inv:function(o,e,r){return-1.4142135623730951*r*s.erfcinv(2*o)+e},mean:function(o){return o},median:function(e){return e},mode:function(o){return o},sample:function(e,r){return s.randn()*r+e},variance:function(o,e){return e*e}}),s.extend(s.pareto,{pdf:function(e,r,n){return e<r?0:n*u.pow(r,n)/u.pow(e,n+1)},cdf:function(e,r,n){return e<r?0:1-u.pow(r/e,n)},inv:function(e,r,n){return r/u.pow(1-e,1/n)},mean:function(e,r){if(!(r<=1))return r*u.pow(e,r)/(r-1)},median:function(e,r){return e*(r*u.SQRT2)},mode:function(e){return e},variance:function(o,e){if(!(e<=2))return o*o*e/(u.pow(e-1,2)*(e-2))}}),s.extend(s.studentt,{pdf:function(e,r){return r=r>1e100?1e100:r,1/(u.sqrt(r)*s.betafn(.5,r/2))*u.pow(1+e*e/r,-((r+1)/2))},cdf:function(e,r){var n=r/2;return s.ibeta((e+u.sqrt(e*e+r))/(2*u.sqrt(e*e+r)),n,n)},inv:function(o,e){var r=s.ibetainv(2*u.min(o,1-o),.5*e,.5);return r=u.sqrt(e*(1-r)/r),o>.5?r:-r},mean:function(e){return e>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(e){return s.randn()*u.sqrt(e/(2*s.randg(e/2)))},variance:function(e){return e>2?e/(e-2):e>1?1/0:void 0}}),s.extend(s.weibull,{pdf:function(e,r,n){return e<0||r<0||n<0?0:n/r*u.pow(e/r,n-1)*u.exp(-u.pow(e/r,n))},cdf:function(e,r,n){return e<0?0:1-u.exp(-u.pow(e/r,n))},inv:function(o,e,r){return e*u.pow(-u.log(1-o),1/r)},mean:function(o,e){return o*s.gammafn(1+1/e)},median:function(e,r){return e*u.pow(u.log(2),1/r)},mode:function(e,r){return r<=1?0:e*u.pow((r-1)/r,1/r)},sample:function(e,r){return e*u.pow(-u.log(s._random_fn()),1/r)},variance:function(e,r){return e*e*s.gammafn(1+2/r)-u.pow(s.weibull.mean(e,r),2)}}),s.extend(s.uniform,{pdf:function(e,r,n){return e<r||e>n?0:1/(n-r)},cdf:function(e,r,n){return e<r?0:e<n?(e-r)/(n-r):1},inv:function(o,e,r){return e+o*(r-e)},mean:function(e,r){return .5*(e+r)},median:function(e,r){return s.mean(e,r)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(e,r){return e/2+r/2+(r/2-e/2)*(2*s._random_fn()-1)},variance:function(e,r){return u.pow(r-e,2)/12}});function w(o,e,r,n){for(var i=0,t=1,l=1,f=1,m=0,d=0,c;u.abs((l-d)/l)>n;)d=l,c=-(e+m)*(e+r+m)*o/(e+2*m)/(e+2*m+1),i=l+c*i,t=f+c*t,m=m+1,c=m*(r-m)*o/(e+2*m-1)/(e+2*m),l=i+c*l,f=t+c*f,i=i/f,t=t/f,l=l/f,f=1;return l/e}s.extend(s.binomial,{pdf:function(e,r,n){return n===0||n===1?r*n===e?1:0:s.combination(r,e)*u.pow(n,e)*u.pow(1-n,r-e)},cdf:function(e,r,n){var i,t=1e-10;if(e<0)return 0;if(e>=r)return 1;if(n<0||n>1||r<=0)return NaN;e=u.floor(e);var l=n,f=e+1,m=r-e,d=f+m,c=u.exp(s.gammaln(d)-s.gammaln(m)-s.gammaln(f)+f*u.log(l)+m*u.log(1-l));return l<(f+1)/(d+2)?i=c*w(l,f,m,t):i=1-c*w(1-l,m,f,t),u.round((1-i)*(1/t))/(1/t)}}),s.extend(s.negbin,{pdf:function(e,r,n){return e!==e>>>0?!1:e<0?0:s.combination(e+r-1,r-1)*u.pow(1-n,e)*u.pow(n,r)},cdf:function(e,r,n){var i=0,t=0;if(e<0)return 0;for(;t<=e;t++)i+=s.negbin.pdf(t,r,n);return i}}),s.extend(s.hypgeom,{pdf:function(e,r,n,i){if(e!==e|0)return!1;if(e<0||e<n-(r-i))return 0;if(e>i||e>n)return 0;if(n*2>r)return i*2>r?s.hypgeom.pdf(r-n-i+e,r,r-n,r-i):s.hypgeom.pdf(i-e,r,r-n,i);if(i*2>r)return s.hypgeom.pdf(n-e,r,n,r-i);if(n<i)return s.hypgeom.pdf(e,r,i,n);for(var t=1,l=0,f=0;f<e;f++){for(;t>1&&l<i;)t*=1-n/(r-l),l++;t*=(i-f)*(n-f)/((f+1)*(r-n-i+f+1))}for(;l<i;l++)t*=1-n/(r-l);return u.min(1,u.max(0,t))},cdf:function(e,r,n,i){if(e<0||e<n-(r-i))return 0;if(e>=i||e>=n)return 1;if(n*2>r)return i*2>r?s.hypgeom.cdf(r-n-i+e,r,r-n,r-i):1-s.hypgeom.cdf(i-e-1,r,r-n,i);if(i*2>r)return 1-s.hypgeom.cdf(n-e-1,r,n,r-i);if(n<i)return s.hypgeom.cdf(e,r,i,n);for(var t=1,l=1,f=0,m=0;m<e;m++){for(;t>1&&f<i;){var d=1-n/(r-f);l*=d,t*=d,f++}l*=(i-m)*(n-m)/((m+1)*(r-n-i+m+1)),t+=l}for(;f<i;f++)t*=1-n/(r-f);return u.min(1,u.max(0,t))}}),s.extend(s.poisson,{pdf:function(e,r){return r<0||e%1!==0||e<0?0:u.pow(r,e)*u.exp(-r)/s.factorial(e)},cdf:function(e,r){var n=[],i=0;if(e<0)return 0;for(;i<=e;i++)n.push(s.poisson.pdf(i,r));return s.sum(n)},mean:function(o){return o},variance:function(o){return o},sampleSmall:function(e){var r=1,n=0,i=u.exp(-e);do n++,r*=s._random_fn();while(r>i);return n-1},sampleLarge:function(e){var r=e,n,i,t,l,f,m,d,c,a,p;for(l=u.sqrt(r),f=u.log(r),d=.931+2.53*l,m=-.059+.02483*d,c=1.1239+1.1328/(d-3.4),a=.9277-3.6224/(d-2);;){if(i=u.random()-.5,t=u.random(),p=.5-u.abs(i),n=u.floor((2*m/p+d)*i+r+.43),p>=.07&&t<=a)return n;if(!(n<0||p<.013&&t>p)&&u.log(t)+u.log(c)-u.log(m/(p*p)+d)<=-r+n*f-s.loggam(n+1))return n}},sample:function(e){return e<10?this.sampleSmall(e):this.sampleLarge(e)}}),s.extend(s.triangular,{pdf:function(e,r,n,i){return n<=r||i<r||i>n?NaN:e<r||e>n?0:e<i?2*(e-r)/((n-r)*(i-r)):e===i?2/(n-r):2*(n-e)/((n-r)*(n-i))},cdf:function(e,r,n,i){return n<=r||i<r||i>n?NaN:e<=r?0:e>=n?1:e<=i?u.pow(e-r,2)/((n-r)*(i-r)):1-u.pow(n-e,2)/((n-r)*(n-i))},inv:function(e,r,n,i){return n<=r||i<r||i>n?NaN:e<=(i-r)/(n-r)?r+(n-r)*u.sqrt(e*((i-r)/(n-r))):r+(n-r)*(1-u.sqrt((1-e)*(1-(i-r)/(n-r))))},mean:function(e,r,n){return(e+r+n)/3},median:function(e,r,n){if(n<=(e+r)/2)return r-u.sqrt((r-e)*(r-n))/u.sqrt(2);if(n>(e+r)/2)return e+u.sqrt((r-e)*(n-e))/u.sqrt(2)},mode:function(e,r,n){return n},sample:function(e,r,n){var i=s._random_fn();return i<(n-e)/(r-e)?e+u.sqrt(i*(r-e)*(n-e)):r-u.sqrt((1-i)*(r-e)*(r-n))},variance:function(e,r,n){return(e*e+r*r+n*n-e*r-e*n-r*n)/18}}),s.extend(s.arcsine,{pdf:function(e,r,n){return n<=r?NaN:e<=r||e>=n?0:2/u.PI*u.pow(u.pow(n-r,2)-u.pow(2*e-r-n,2),-.5)},cdf:function(e,r,n){return e<r?0:e<n?2/u.PI*u.asin(u.sqrt((e-r)/(n-r))):1},inv:function(o,e,r){return e+(.5-.5*u.cos(u.PI*o))*(r-e)},mean:function(e,r){return r<=e?NaN:(e+r)/2},median:function(e,r){return r<=e?NaN:(e+r)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(e,r){return(e+r)/2+(r-e)/2*u.sin(2*u.PI*s.uniform.sample(0,1))},variance:function(e,r){return r<=e?NaN:u.pow(r-e,2)/8}});function g(o){return o/u.abs(o)}s.extend(s.laplace,{pdf:function(e,r,n){return n<=0?0:u.exp(-u.abs(e-r)/n)/(2*n)},cdf:function(e,r,n){return n<=0?0:e<r?.5*u.exp((e-r)/n):1-.5*u.exp(-(e-r)/n)},mean:function(o){return o},median:function(o){return o},mode:function(o){return o},variance:function(o,e){return 2*e*e},sample:function(e,r){var n=s._random_fn()-.5;return e-r*g(n)*u.log(1-2*u.abs(n))}});function x(o,e,r){var n=12,i=6,t=-30,l=-50,f=60,m=8,d=3,c=2,a=3,p=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],y=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],b=o*.5;if(b>=m)return 1;var q=2*s.normal.cdf(b,0,1,1,0)-1;q>=u.exp(l/r)?q=u.pow(q,r):q=0;var R;o>d?R=c:R=a;for(var _=b,P=(m-b)/R,I=_+P,A=0,V=r-1,H=1;H<=R;H++){for(var W=0,O=.5*(I+_),$=.5*(I-_),G=1;G<=n;G++){var F,Q;i<G?(F=n-G+1,Q=p[F-1]):(F=G,Q=-p[F-1]);var T=$*Q,L=O+T,J=L*L;if(J>f)break;var C=2*s.normal.cdf(L,0,1,1,0),B=2*s.normal.cdf(L,o,1,1,0),U=C*.5-B*.5;U>=u.exp(t/V)&&(U=y[F-1]*u.exp(-(.5*J))*u.pow(U,V),W+=U)}W*=2*$*r/u.sqrt(2*u.PI),A+=W,_=I,I+=P}return q+=A,q<=u.exp(t/e)?0:(q=u.pow(q,e),q>=1?1:q)}function v(o,e,r){var n=.322232421088,i=.099348462606,t=-1,l=.588581570495,f=-.342242088547,m=.531103462366,d=-.204231210125,c=.10353775285,a=-453642210148e-16,p=.0038560700634,y=.8832,b=.2368,q=1.208,R=1.4142,_=120,P=.5-.5*o,I=u.sqrt(u.log(1/(P*P))),A=I+((((I*a+d)*I+f)*I+t)*I+n)/((((I*p+c)*I+m)*I+l)*I+i);r<_&&(A+=(A*A*A+A)/r/4);var V=y-b*A;return r<_&&(V+=-1.214/r+q*A/r),A*(V*u.log(e-1)+R)}s.extend(s.tukey,{cdf:function(e,r,n){var i=1,t=r,l=16,f=8,m=-30,d=1e-14,c=100,a=800,p=5e3,y=25e3,b=1,q=.5,R=.25,_=.125,P=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],I=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(e<=0)return 0;if(n<2||i<1||t<2)return NaN;if(!Number.isFinite(e))return 1;if(n>y)return x(e,i,t);var A=n*.5,V=A*u.log(n)-n*u.log(2)-s.gammaln(A),H=A-1,W=n*.25,O;n<=c?O=b:n<=a?O=q:n<=p?O=R:O=_,V+=u.log(O);for(var $=0,G=1;G<=50;G++){for(var F=0,Q=(2*G-1)*O,T=1;T<=l;T++){var L,J;f<T?(L=T-f-1,J=V+H*u.log(Q+P[L]*O)-(P[L]*O+Q)*W):(L=T-1,J=V+H*u.log(Q-P[L]*O)+(P[L]*O-Q)*W);var C;if(J>=m){f<T?C=e*u.sqrt((P[L]*O+Q)*.5):C=e*u.sqrt((-(P[L]*O)+Q)*.5);var B=x(C,i,t),U=B*I[L]*u.exp(J);F+=U}}if(G*O>=1&&F<=d)break;$+=F}if(F>d)throw new Error("tukey.cdf failed to converge");return $>1&&($=1),$},inv:function(o,e,r){var n=1,i=e,t=1e-4,l=50;if(r<2||n<1||i<2)return NaN;if(o<0||o>1)return NaN;if(o===0)return 0;if(o===1)return 1/0;var f=v(o,i,r),m=s.tukey.cdf(f,e,r)-o,d;m>0?d=u.max(0,f-1):d=f+1;for(var c=s.tukey.cdf(d,e,r)-o,a,p=1;p<l;p++){a=d-c*(d-f)/(c-m),m=c,f=d,a<0&&(a=0,c=-o),c=s.tukey.cdf(a,e,r)-o,d=a;var y=u.abs(d-f);if(y<t)return a}throw new Error("tukey.inv failed to converge")}})}(N,Math),function(s,u){var w=Array.prototype.push,g=s.utils.isArray;function x(v){return g(v)||v instanceof s}s.extend({add:function(o,e){return x(e)?(x(e[0])||(e=[e]),s.map(o,function(r,n,i){return r+e[n][i]})):s.map(o,function(r){return r+e})},subtract:function(o,e){return x(e)?(x(e[0])||(e=[e]),s.map(o,function(r,n,i){return r-e[n][i]||0})):s.map(o,function(r){return r-e})},divide:function(o,e){return x(e)?(x(e[0])||(e=[e]),s.multiply(o,s.inv(e))):s.map(o,function(r){return r/e})},multiply:function(o,e){var r,n,i,t,l,f,m,d;if(o.length===void 0&&e.length===void 0)return o*e;if(l=o.length,f=o[0].length,m=s.zeros(l,i=x(e)?e[0].length:f),d=0,x(e)){for(;d<i;d++)for(r=0;r<l;r++){for(t=0,n=0;n<f;n++)t+=o[r][n]*e[n][d];m[r][d]=t}return l===1&&d===1?m[0][0]:m}return s.map(o,function(c){return c*e})},outer:function(o,e){return s.multiply(o.map(function(r){return[r]}),[e])},dot:function(o,e){x(o[0])||(o=[o]),x(e[0])||(e=[e]);for(var r=o[0].length===1&&o.length!==1?s.transpose(o):o,n=e[0].length===1&&e.length!==1?s.transpose(e):e,i=[],t=0,l=r.length,f=r[0].length,m,d;t<l;t++){for(i[t]=[],m=0,d=0;d<f;d++)m+=r[t][d]*n[t][d];i[t]=m}return i.length===1?i[0]:i},pow:function(o,e){return s.map(o,function(r){return u.pow(r,e)})},exp:function(o){return s.map(o,function(e){return u.exp(e)})},log:function(o){return s.map(o,function(e){return u.log(e)})},abs:function(o){return s.map(o,function(e){return u.abs(e)})},norm:function(o,e){var r=0,n=0;for(isNaN(e)&&(e=2),x(o[0])&&(o=o[0]);n<o.length;n++)r+=u.pow(u.abs(o[n]),e);return u.pow(r,1/e)},angle:function(o,e){return u.acos(s.dot(o,e)/(s.norm(o)*s.norm(e)))},aug:function(o,e){var r=[],n;for(n=0;n<o.length;n++)r.push(o[n].slice());for(n=0;n<r.length;n++)w.apply(r[n],e[n]);return r},inv:function(o){for(var e=o.length,r=o[0].length,n=s.identity(e,r),i=s.gauss_jordan(o,n),t=[],l=0,f;l<e;l++)for(t[l]=[],f=r;f<i[0].length;f++)t[l][f-r]=i[l][f];return t},det:function v(o){if(o.length===2)return o[0][0]*o[1][1]-o[0][1]*o[1][0];for(var e=0,r=0;r<o.length;r++){for(var n=[],i=1;i<o.length;i++){n[i-1]=[];for(var t=0;t<o.length;t++)t<r?n[i-1][t]=o[i][t]:t>r&&(n[i-1][t-1]=o[i][t])}var l=r%2?-1:1;e+=v(n)*o[0][r]*l}return e},gauss_elimination:function(o,e){var r=0,n=0,i=o.length,t=o[0].length,l=1,f=0,m=[],d,c,a,p;for(o=s.aug(o,e),d=o[0].length,r=0;r<i;r++){for(c=o[r][r],n=r,p=r+1;p<t;p++)c<u.abs(o[p][r])&&(c=o[p][r],n=p);if(n!=r)for(p=0;p<d;p++)a=o[r][p],o[r][p]=o[n][p],o[n][p]=a;for(n=r+1;n<i;n++)for(l=o[n][r]/o[r][r],p=r;p<d;p++)o[n][p]=o[n][p]-l*o[r][p]}for(r=i-1;r>=0;r--){for(f=0,n=r+1;n<=i-1;n++)f=f+m[n]*o[r][n];m[r]=(o[r][d-1]-f)/o[r][r]}return m},gauss_jordan:function(o,e){var r=s.aug(o,e),n=r.length,i=r[0].length,t=0,l,f,m;for(f=0;f<n;f++){var d=f;for(m=f+1;m<n;m++)u.abs(r[m][f])>u.abs(r[d][f])&&(d=m);var c=r[f];for(r[f]=r[d],r[d]=c,m=f+1;m<n;m++)for(t=r[m][f]/r[f][f],l=f;l<i;l++)r[m][l]-=r[f][l]*t}for(f=n-1;f>=0;f--){for(t=r[f][f],m=0;m<f;m++)for(l=i-1;l>f-1;l--)r[m][l]-=r[f][l]*r[m][f]/t;for(r[f][f]/=t,l=n;l<i;l++)r[f][l]/=t}return r},triaUpSolve:function(o,e){var r=o[0].length,n=s.zeros(1,r)[0],i,t=!1;return e[0].length!=null&&(e=e.map(function(l){return l[0]}),t=!0),s.arange(r-1,-1,-1).forEach(function(l){i=s.arange(l+1,r).map(function(f){return n[f]*o[l][f]}),n[l]=(e[l]-s.sum(i))/o[l][l]}),t?n.map(function(l){return[l]}):n},triaLowSolve:function(o,e){var r=o[0].length,n=s.zeros(1,r)[0],i,t=!1;return e[0].length!=null&&(e=e.map(function(l){return l[0]}),t=!0),s.arange(r).forEach(function(l){i=s.arange(l).map(function(f){return o[l][f]*n[f]}),n[l]=(e[l]-s.sum(i))/o[l][l]}),t?n.map(function(l){return[l]}):n},lu:function(o){var e=o.length,r=s.identity(e),n=s.zeros(o.length,o[0].length),i;return s.arange(e).forEach(function(t){n[0][t]=o[0][t]}),s.arange(1,e).forEach(function(t){s.arange(t).forEach(function(l){i=s.arange(l).map(function(f){return r[t][f]*n[f][l]}),r[t][l]=(o[t][l]-s.sum(i))/n[l][l]}),s.arange(t,e).forEach(function(l){i=s.arange(t).map(function(f){return r[t][f]*n[f][l]}),n[t][l]=o[i.length][l]-s.sum(i)})}),[r,n]},cholesky:function(o){var e=o.length,r=s.zeros(o.length,o[0].length),n;return s.arange(e).forEach(function(i){n=s.arange(i).map(function(t){return u.pow(r[i][t],2)}),r[i][i]=u.sqrt(o[i][i]-s.sum(n)),s.arange(i+1,e).forEach(function(t){n=s.arange(i).map(function(l){return r[i][l]*r[t][l]}),r[t][i]=(o[i][t]-s.sum(n))/r[i][i]})}),r},gauss_jacobi:function(o,e,r,n){for(var i=0,t=0,l=o.length,f=[],m=[],d=[],c,a,p,y;i<l;i++)for(f[i]=[],m[i]=[],d[i]=[],t=0;t<l;t++)i>t?(f[i][t]=o[i][t],m[i][t]=d[i][t]=0):i<t?(m[i][t]=o[i][t],f[i][t]=d[i][t]=0):(d[i][t]=o[i][t],f[i][t]=m[i][t]=0);for(p=s.multiply(s.multiply(s.inv(d),s.add(f,m)),-1),a=s.multiply(s.inv(d),e),c=r,y=s.add(s.multiply(p,r),a),i=2;u.abs(s.norm(s.subtract(y,c)))>n;)c=y,y=s.add(s.multiply(p,c),a),i++;return y},gauss_seidel:function(o,e,r,n){for(var i=0,t=o.length,l=[],f=[],m=[],d,c,a,p,y;i<t;i++)for(l[i]=[],f[i]=[],m[i]=[],d=0;d<t;d++)i>d?(l[i][d]=o[i][d],f[i][d]=m[i][d]=0):i<d?(f[i][d]=o[i][d],l[i][d]=m[i][d]=0):(m[i][d]=o[i][d],l[i][d]=f[i][d]=0);for(p=s.multiply(s.multiply(s.inv(s.add(m,l)),f),-1),a=s.multiply(s.inv(s.add(m,l)),e),c=r,y=s.add(s.multiply(p,r),a),i=2;u.abs(s.norm(s.subtract(y,c)))>n;)c=y,y=s.add(s.multiply(p,c),a),i=i+1;return y},SOR:function(o,e,r,n,i){for(var t=0,l=o.length,f=[],m=[],d=[],c,a,p,y,b;t<l;t++)for(f[t]=[],m[t]=[],d[t]=[],c=0;c<l;c++)t>c?(f[t][c]=o[t][c],m[t][c]=d[t][c]=0):t<c?(m[t][c]=o[t][c],f[t][c]=d[t][c]=0):(d[t][c]=o[t][c],f[t][c]=m[t][c]=0);for(y=s.multiply(s.inv(s.add(d,s.multiply(f,i))),s.subtract(s.multiply(d,1-i),s.multiply(m,i))),p=s.multiply(s.multiply(s.inv(s.add(d,s.multiply(f,i))),e),i),a=r,b=s.add(s.multiply(y,r),p),t=2;u.abs(s.norm(s.subtract(b,a)))>n;)a=b,b=s.add(s.multiply(y,a),p),t++;return b},householder:function(o){for(var e=o.length,r=o[0].length,n=0,i=[],t=[],l,f,m,d,c;n<e-1;n++){for(l=0,d=n+1;d<r;d++)l+=o[d][n]*o[d][n];for(c=o[n+1][n]>0?-1:1,l=c*u.sqrt(l),f=u.sqrt((l*l-o[n+1][n]*l)/2),i=s.zeros(e,1),i[n+1][0]=(o[n+1][n]-l)/(2*f),m=n+2;m<e;m++)i[m][0]=o[m][n]/(2*f);t=s.subtract(s.identity(e,r),s.multiply(s.multiply(i,s.transpose(i)),2)),o=s.multiply(t,s.multiply(o,t))}return o},QR:function(){var v=s.sum,o=s.arange;function e(r){var n=r.length,i=r[0].length,t=s.zeros(i,i);r=s.copy(r);var l,f,m;for(f=0;f<i;f++){for(t[f][f]=u.sqrt(v(o(n).map(function(d){return r[d][f]*r[d][f]}))),l=0;l<n;l++)r[l][f]=r[l][f]/t[f][f];for(m=f+1;m<i;m++)for(t[f][m]=v(o(n).map(function(d){return r[d][f]*r[d][m]})),l=0;l<n;l++)r[l][m]=r[l][m]-r[l][f]*t[f][m]}return[r,t]}return e}(),lstsq:function(){function v(e){e=s.copy(e);var r=e.length,n=s.identity(r);return s.arange(r-1,-1,-1).forEach(function(i){s.sliceAssign(n,{row:i},s.divide(s.slice(n,{row:i}),e[i][i])),s.sliceAssign(e,{row:i},s.divide(s.slice(e,{row:i}),e[i][i])),s.arange(i).forEach(function(t){var l=s.multiply(e[t][i],-1),f=s.slice(e,{row:t}),m=s.multiply(s.slice(e,{row:i}),l);s.sliceAssign(e,{row:t},s.add(f,m));var d=s.slice(n,{row:t}),c=s.multiply(s.slice(n,{row:i}),l);s.sliceAssign(n,{row:t},s.add(d,c))})}),n}function o(e,r){var n=!1;r[0].length===void 0&&(r=r.map(function(y){return[y]}),n=!0);var i=s.QR(e),t=i[0],l=i[1],f=e[0].length,m=s.slice(t,{col:{end:f}}),d=s.slice(l,{row:{end:f}}),c=v(d),a=s.transpose(m);a[0].length===void 0&&(a=[a]);var p=s.multiply(s.multiply(c,a),r);return p.length===void 0&&(p=[[p]]),n?p.map(function(y){return y[0]}):p}return o}(),jacobi:function(o){for(var e=1,r=o.length,n=s.identity(r,r),i=[],t,l,f,m,d,c,a,p;e===1;){for(c=o[0][1],m=0,d=1,l=0;l<r;l++)for(f=0;f<r;f++)l!=f&&c<u.abs(o[l][f])&&(c=u.abs(o[l][f]),m=l,d=f);for(o[m][m]===o[d][d]?a=o[m][d]>0?u.PI/4:-u.PI/4:a=u.atan(2*o[m][d]/(o[m][m]-o[d][d]))/2,p=s.identity(r,r),p[m][m]=u.cos(a),p[m][d]=-u.sin(a),p[d][m]=u.sin(a),p[d][d]=u.cos(a),n=s.multiply(n,p),t=s.multiply(s.multiply(s.inv(p),o),p),o=t,e=0,l=1;l<r;l++)for(f=1;f<r;f++)l!=f&&u.abs(o[l][f])>.001&&(e=1)}for(l=0;l<r;l++)i.push(o[l][l]);return[n,i]},rungekutta:function(o,e,r,n,i,t){var l,f,m,d,c;if(t===2)for(;n<=r;)l=e*o(n,i),f=e*o(n+e,i+l),m=i+(l+f)/2,i=m,n=n+e;if(t===4)for(;n<=r;)l=e*o(n,i),f=e*o(n+e/2,i+l/2),d=e*o(n+e/2,i+f/2),c=e*o(n+e,i+d),m=i+(l+2*f+2*d+c)/6,i=m,n=n+e;return i},romberg:function(o,e,r,n){for(var i=0,t=(r-e)/2,l=[],f=[],m=[],d,c,a,p,y;i<n/2;){for(y=o(e),a=e,p=0;a<=r;a=a+t,p++)l[p]=a;for(d=l.length,a=1;a<d-1;a++)y+=(a%2!==0?4:2)*o(l[a]);y=t/3*(y+o(r)),m[i]=y,t/=2,i++}for(c=m.length,d=1;c!==1;){for(a=0;a<c-1;a++)f[a]=(u.pow(4,d)*m[a+1]-m[a])/(u.pow(4,d)-1);c=f.length,m=f,f=[],d++}return m},richardson:function(o,e,r,n){function i(b,q){for(var R=0,_=b.length,P;R<_;R++)b[R]===q&&(P=R);return P}for(var t=u.abs(r-o[i(o,r)+1]),l=0,f=[],m=[],d,c,a,p,y;n>=t;)d=i(o,r+n),c=i(o,r),f[l]=(e[d]-2*e[c]+e[2*c-d])/(n*n),n/=2,l++;for(p=f.length,a=1;p!=1;){for(y=0;y<p-1;y++)m[y]=(u.pow(4,a)*f[y+1]-f[y])/(u.pow(4,a)-1);p=m.length,f=m,m=[],a++}return f},simpson:function(o,e,r,n){for(var i=(r-e)/n,t=o(e),l=[],f=e,m=0,d=1,c;f<=r;f=f+i,m++)l[m]=f;for(c=l.length;d<c-1;d++)t+=(d%2!==0?4:2)*o(l[d]);return i/3*(t+o(r))},hermite:function(o,e,r,n){for(var i=o.length,t=0,l=0,f=[],m=[],d=[],c=[],a;l<i;l++){for(f[l]=1,a=0;a<i;a++)l!=a&&(f[l]*=(n-o[a])/(o[l]-o[a]));for(m[l]=0,a=0;a<i;a++)l!=a&&(m[l]+=1/(o[l]-o[a]));d[l]=(1-2*(n-o[l])*m[l])*(f[l]*f[l]),c[l]=(n-o[l])*(f[l]*f[l]),t+=d[l]*e[l]+c[l]*r[l]}return t},lagrange:function(o,e,r){for(var n=0,i=0,t,l,f=o.length;i<f;i++){for(l=e[i],t=0;t<f;t++)i!=t&&(l*=(r-o[t])/(o[i]-o[t]));n+=l}return n},cubic_spline:function(o,e,r){for(var n=o.length,i=0,t,l=[],f=[],m=[],d=[],c=[],a=[],p=[];i<n-1;i++)c[i]=o[i+1]-o[i];for(m[0]=0,i=1;i<n-1;i++)m[i]=3/c[i]*(e[i+1]-e[i])-3/c[i-1]*(e[i]-e[i-1]);for(i=1;i<n-1;i++)l[i]=[],f[i]=[],l[i][i-1]=c[i-1],l[i][i]=2*(c[i-1]+c[i]),l[i][i+1]=c[i],f[i][0]=m[i];for(d=s.multiply(s.inv(l),f),t=0;t<n-1;t++)a[t]=(e[t+1]-e[t])/c[t]-c[t]*(d[t+1][0]+2*d[t][0])/3,p[t]=(d[t+1][0]-d[t][0])/(3*c[t]);for(t=0;t<n&&!(o[t]>r);t++);return t-=1,e[t]+(r-o[t])*a[t]+s.sq(r-o[t])*d[t]+(r-o[t])*s.sq(r-o[t])*p[t]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(o){var e=o.length,r=o[0].length,n=0,i,t,l=[],f=[],m=[],d=[],c=[],a=[],p=[],y=[],b=[],q=[];for(n=0;n<e;n++)l[n]=s.sum(o[n])/r;for(n=0;n<r;n++)for(p[n]=[],i=0;i<e;i++)p[n][i]=o[i][n]-l[i];for(p=s.transpose(p),n=0;n<e;n++)for(y[n]=[],i=0;i<e;i++)y[n][i]=s.dot([p[n]],[p[i]])/(r-1);for(m=s.jacobi(y),b=m[0],f=m[1],q=s.transpose(b),n=0;n<f.length;n++)for(i=n;i<f.length;i++)f[n]<f[i]&&(t=f[n],f[n]=f[i],f[i]=t,d=q[n],q[n]=q[i],q[i]=d);for(a=s.transpose(p),n=0;n<e;n++)for(c[n]=[],i=0;i<a.length;i++)c[n][i]=s.dot([q[n]],[a[i]]);return[o,f,q,c]}}),function(v){for(var o=0;o<v.length;o++)(function(e){s.fn[e]=function(r,n){var i=this;return n?(setTimeout(function(){n.call(i,s.fn[e].call(i,r))},15),this):typeof s[e](this,r)=="number"?s[e](this,r):s(s[e](this,r))}})(v[o])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(N,Math),function(s,u){var w=[].slice,g=s.utils.isNumber,x=s.utils.isArray;s.extend({zscore:function(){var e=w.call(arguments);return g(e[1])?(e[0]-e[1])/e[2]:(e[0]-s.mean(e[1]))/s.stdev(e[1],e[2])},ztest:function(){var e=w.call(arguments),r;return x(e[1])?(r=s.zscore(e[0],e[1],e[3]),e[2]===1?s.normal.cdf(-u.abs(r),0,1):s.normal.cdf(-u.abs(r),0,1)*2):e.length>2?(r=s.zscore(e[0],e[1],e[2]),e[3]===1?s.normal.cdf(-u.abs(r),0,1):s.normal.cdf(-u.abs(r),0,1)*2):(r=e[0],e[1]===1?s.normal.cdf(-u.abs(r),0,1):s.normal.cdf(-u.abs(r),0,1)*2)}}),s.extend(s.fn,{zscore:function(e,r){return(e-this.mean())/this.stdev(r)},ztest:function(e,r,n){var i=u.abs(this.zscore(e,n));return r===1?s.normal.cdf(-i,0,1):s.normal.cdf(-i,0,1)*2}}),s.extend({tscore:function(){var e=w.call(arguments);return e.length===4?(e[0]-e[1])/(e[2]/u.sqrt(e[3])):(e[0]-s.mean(e[1]))/(s.stdev(e[1],!0)/u.sqrt(e[1].length))},ttest:function(){var e=w.call(arguments),r;return e.length===5?(r=u.abs(s.tscore(e[0],e[1],e[2],e[3])),e[4]===1?s.studentt.cdf(-r,e[3]-1):s.studentt.cdf(-r,e[3]-1)*2):g(e[1])?(r=u.abs(e[0]),e[2]==1?s.studentt.cdf(-r,e[1]-1):s.studentt.cdf(-r,e[1]-1)*2):(r=u.abs(s.tscore(e[0],e[1])),e[2]==1?s.studentt.cdf(-r,e[1].length-1):s.studentt.cdf(-r,e[1].length-1)*2)}}),s.extend(s.fn,{tscore:function(e){return(e-this.mean())/(this.stdev(!0)/u.sqrt(this.cols()))},ttest:function(e,r){return r===1?1-s.studentt.cdf(u.abs(this.tscore(e)),this.cols()-1):s.studentt.cdf(-u.abs(this.tscore(e)),this.cols()-1)*2}}),s.extend({anovafscore:function(){var e=w.call(arguments),r,n,i,t,l,f,m,d;if(e.length===1){for(l=new Array(e[0].length),m=0;m<e[0].length;m++)l[m]=e[0][m];e=l}for(n=new Array,m=0;m<e.length;m++)n=n.concat(e[m]);for(i=s.mean(n),r=0,m=0;m<e.length;m++)r=r+e[m].length*u.pow(s.mean(e[m])-i,2);for(r/=e.length-1,f=0,m=0;m<e.length;m++)for(t=s.mean(e[m]),d=0;d<e[m].length;d++)f+=u.pow(e[m][d]-t,2);return f/=n.length-e.length,r/f},anovaftest:function(){var e=w.call(arguments),r,n,i,t;if(g(e[0]))return 1-s.centralF.cdf(e[0],e[1],e[2]);var l=s.anovafscore(e);for(r=e.length-1,i=0,t=0;t<e.length;t++)i=i+e[t].length;return n=i-r-1,1-s.centralF.cdf(l,r,n)},ftest:function(e,r,n){return 1-s.centralF.cdf(e,r,n)}}),s.extend(s.fn,{anovafscore:function(){return s.anovafscore(this.toArray())},anovaftes:function(){var e=0,r;for(r=0;r<this.length;r++)e=e+this[r].length;return s.ftest(this.anovafscore(),this.length-1,e-this.length)}}),s.extend({qscore:function(){var e=w.call(arguments),r,n,i,t,l;return g(e[0])?(r=e[0],n=e[1],i=e[2],t=e[3],l=e[4]):(r=s.mean(e[0]),n=s.mean(e[1]),i=e[0].length,t=e[1].length,l=e[2]),u.abs(r-n)/(l*u.sqrt((1/i+1/t)/2))},qtest:function(){var e=w.call(arguments),r;e.length===3?(r=e[0],e=e.slice(1)):e.length===7?(r=s.qscore(e[0],e[1],e[2],e[3],e[4]),e=e.slice(5)):(r=s.qscore(e[0],e[1],e[2]),e=e.slice(3));var n=e[0],i=e[1];return 1-s.tukey.cdf(r,i,n-i)},tukeyhsd:function(e){for(var r=s.pooledstdev(e),n=e.map(function(d){return s.mean(d)}),i=e.reduce(function(d,c){return d+c.length},0),t=[],l=0;l<e.length;++l)for(var f=l+1;f<e.length;++f){var m=s.qtest(n[l],n[f],e[l].length,e[f].length,r,i,e.length);t.push([[l,f],m])}return t}}),s.extend({normalci:function(){var e=w.call(arguments),r=new Array(2),n;return e.length===4?n=u.abs(s.normal.inv(e[1]/2,0,1)*e[2]/u.sqrt(e[3])):n=u.abs(s.normal.inv(e[1]/2,0,1)*s.stdev(e[2])/u.sqrt(e[2].length)),r[0]=e[0]-n,r[1]=e[0]+n,r},tci:function(){var e=w.call(arguments),r=new Array(2),n;return e.length===4?n=u.abs(s.studentt.inv(e[1]/2,e[3]-1)*e[2]/u.sqrt(e[3])):n=u.abs(s.studentt.inv(e[1]/2,e[2].length-1)*s.stdev(e[2],!0)/u.sqrt(e[2].length)),r[0]=e[0]-n,r[1]=e[0]+n,r},significant:function(e,r){return e<r}}),s.extend(s.fn,{normalci:function(e,r){return s.normalci(e,r,this.toArray())},tci:function(e,r){return s.tci(e,r,this.toArray())}});function v(o,e,r,n){if(o>1||r>1||o<=0||r<=0)throw new Error("Proportions should be greater than 0 and less than 1");var i=(o*e+r*n)/(e+n),t=u.sqrt(i*(1-i)*(1/e+1/n));return(o-r)/t}s.extend(s.fn,{oneSidedDifferenceOfProportions:function(e,r,n,i){var t=v(e,r,n,i);return s.ztest(t,1)},twoSidedDifferenceOfProportions:function(e,r,n,i){var t=v(e,r,n,i);return s.ztest(t,2)}})}(N,Math),N.models=function(){function s(v){var o=v[0].length,e=N.arange(o).map(function(r){var n=N.arange(o).filter(function(i){return i!==r});return u(N.col(v,r).map(function(i){return i[0]}),N.col(v,n))});return e}function u(v,o){var e=v.length,r=o[0].length-1,n=e-r-1,i=N.lstsq(o,v),t=N.multiply(o,i.map(function(p){return[p]})).map(function(p){return p[0]}),l=N.subtract(v,t),f=N.mean(v),m=N.sum(t.map(function(p){return Math.pow(p-f,2)})),d=N.sum(v.map(function(p,y){return Math.pow(p-t[y],2)})),c=m+d,a=m/c;return{exog:o,endog:v,nobs:e,df_model:r,df_resid:n,coef:i,predict:t,resid:l,ybar:f,SST:c,SSE:m,SSR:d,R2:a}}function w(v){var o=s(v.exog),e=Math.sqrt(v.SSR/v.df_resid),r=o.map(function(f){var m=f.SST,d=f.R2;return e/Math.sqrt(m*(1-d))}),n=v.coef.map(function(f,m){return(f-0)/r[m]}),i=n.map(function(f){var m=N.studentt.cdf(f,v.df_resid);return(m>.5?1-m:m)*2}),t=N.studentt.inv(.975,v.df_resid),l=v.coef.map(function(f,m){var d=t*r[m];return[f-d,f+d]});return{se:r,t:n,p:i,sigmaHat:e,interval95:l}}function g(v){var o=v.R2/v.df_model/((1-v.R2)/v.df_resid),e=function(n,i,t){return N.beta.cdf(n/(t/i+n),i/2,t/2)},r=1-e(o,v.df_model,v.df_resid);return{F_statistic:o,pvalue:r}}function x(v,o){var e=u(v,o),r=w(e),n=g(e),i=1-(1-e.R2)*((e.nobs-1)/e.df_resid);return e.t=r,e.f=n,e.adjust_R2=i,e}return{ols:x}}(),N.extend({buildxmatrix:function(){for(var u=new Array(arguments.length),w=0;w<arguments.length;w++){var g=[1];u[w]=g.concat(arguments[w])}return N(u)},builddxmatrix:function(){for(var u=new Array(arguments[0].length),w=0;w<arguments[0].length;w++){var g=[1];u[w]=g.concat(arguments[0][w])}return N(u)},buildjxmatrix:function(u){for(var w=new Array(u.length),g=0;g<u.length;g++)w[g]=u[g];return N.builddxmatrix(w)},buildymatrix:function(u){return N(u).transpose()},buildjymatrix:function(u){return u.transpose()},matrixmult:function(u,w){var g,x,v,o,e;if(u.cols()==w.rows()){if(w.rows()>1){for(o=[],g=0;g<u.rows();g++)for(o[g]=[],x=0;x<w.cols();x++){for(e=0,v=0;v<u.cols();v++)e+=u.toArray()[g][v]*w.toArray()[v][x];o[g][x]=e}return N(o)}for(o=[],g=0;g<u.rows();g++)for(o[g]=[],x=0;x<w.cols();x++){for(e=0,v=0;v<u.cols();v++)e+=u.toArray()[g][v]*w.toArray()[x];o[g][x]=e}return N(o)}},regress:function(u,w){var g=N.xtranspxinv(u),x=u.transpose(),v=N.matrixmult(N(g),x);return N.matrixmult(v,w)},regresst:function(u,w,g){var x=N.regress(u,w),v={};v.anova={};var o=N.jMatYBar(u,x);v.yBar=o;var e=w.mean();v.anova.residuals=N.residuals(w,o),v.anova.ssr=N.ssr(o,e),v.anova.msr=v.anova.ssr/(u[0].length-1),v.anova.sse=N.sse(w,o),v.anova.mse=v.anova.sse/(w.length-(u[0].length-1)-1),v.anova.sst=N.sst(w,e),v.anova.mst=v.anova.sst/(w.length-1),v.anova.r2=1-v.anova.sse/v.anova.sst,v.anova.r2<0&&(v.anova.r2=0),v.anova.fratio=v.anova.msr/v.anova.mse,v.anova.pvalue=N.anovaftest(v.anova.fratio,u[0].length-1,w.length-(u[0].length-1)-1),v.anova.rmse=Math.sqrt(v.anova.mse),v.anova.r2adj=1-v.anova.mse/v.anova.mst,v.anova.r2adj<0&&(v.anova.r2adj=0),v.stats=new Array(u[0].length);for(var r=N.xtranspxinv(u),n,i,t,l=0;l<x.length;l++)n=Math.sqrt(v.anova.mse*Math.abs(r[l][l])),i=Math.abs(x[l]/n),t=N.ttest(i,w.length-u[0].length-1,g),v.stats[l]=[x[l],n,i,t];return v.regress=x,v},xtranspx:function(u){return N.matrixmult(u.transpose(),u)},xtranspxinv:function(u){var w=N.matrixmult(u.transpose(),u),g=N.inv(w);return g},jMatYBar:function(u,w){var g=N.matrixmult(u,w);return new N(g)},residuals:function(u,w){return N.matrixsubtract(u,w)},ssr:function(u,w){for(var g=0,x=0;x<u.length;x++)g+=Math.pow(u[x]-w,2);return g},sse:function(u,w){for(var g=0,x=0;x<u.length;x++)g+=Math.pow(u[x]-w[x],2);return g},sst:function(u,w){for(var g=0,x=0;x<u.length;x++)g+=Math.pow(u[x]-w,2);return g},matrixsubtract:function(u,w){for(var g=new Array(u.length),x=0;x<u.length;x++){g[x]=new Array(u[x].length);for(var v=0;v<u[x].length;v++)g[x][v]=u[x][v]-w[x][v]}return N(g)}}),N.jStat=N,N})}(D)),D.exports}var ue=se();const te=ne(ue);function le(k,E,N){return k<=0||k>=1?0:te.beta.pdf(k,E,N)}const M=["#e74c3c","#3498db","#2ecc71","#e67e22","#9b59b6","#8e44ad","#1abc9c","#34495e","#f1c40f","#7f8c8d"];function fe({ads:k}){const E=z.useMemo(()=>{const s=[];for(let w=0;w<100;w++)s.push(w/99);return s},[]),N=z.useMemo(()=>k.map((s,u)=>{const w=E.map(g=>le(g,s.alpha,s.beta));return{x:E,y:w,mode:"lines",name:`Ad ${s.id+1}`,line:{color:M[u%M.length]}}}),[k,E]);return h.jsx("div",{className:"w-full",children:h.jsx(j,{data:N,layout:{title:"Beta Prior Distributions",xaxis:{title:"CTR",range:[0,1]},yaxis:{title:"Density"},margin:{t:40,r:20,b:40,l:50},showlegend:!0},config:{displayModeBar:!1,responsive:!0},style:{width:"100%",height:360}})})}function ce({numAds:k,setNumAds:E,seed:N,setSeed:s,dynamicEnv:u,setDynamicEnv:w,onInit:g}){return h.jsx("div",{className:"px-2 py-3",children:h.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-3",children:[h.jsxs("label",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-sm",children:"Ads:"}),h.jsx(Z,{type:"number",min:1,max:12,value:k,onChange:x=>E(Number(x.target.value)),className:"w-20"})]}),h.jsxs("label",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-sm",children:"Seed:"}),h.jsx(Z,{type:"text",value:N,onChange:x=>s(x.target.value),placeholder:"optional",className:"w-36"})]}),h.jsxs("label",{className:"flex items-center gap-2",children:[h.jsx("input",{type:"checkbox",checked:u,onChange:x=>w(x.target.checked),className:"size-4"}),h.jsx("span",{className:"text-sm",children:"Dynamic Environment"})]}),h.jsx(K,{onClick:g,variant:"outline",children:"Reinitialize Ads"})]})})}function ae({initialized:k,speedSec:E,setSpeedSec:N,continuous:s,setContinuous:u,stepsPerTick:w,setStepsPerTick:g,running:x,decay:v,setDecay:o,chartExpected:e,setChartExpected:r,onStart:n,onPause:i,onReset:t}){return h.jsxs("div",{className:"px-2 py-3",children:[h.jsxs("div",{className:"flex flex-wrap items-center gap-3 justify-center mb-3",children:[h.jsxs("label",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-sm",children:"Speed (sec/step):"}),h.jsx(Z,{type:"number",step:.1,min:.05,value:E,onChange:l=>N(Number(l.target.value)),className:"w-24",disabled:!k})]}),h.jsxs("label",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-sm",children:"Steps per tick:"}),h.jsx(Z,{type:"number",min:1,value:w,onChange:l=>g(Math.max(1,Number(l.target.value))),className:"w-24",disabled:!k})]}),h.jsxs("label",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-sm",children:"Prior Decay (0-1):"}),h.jsx(Z,{type:"number",min:0,max:1,step:.01,value:v,onChange:l=>o(Math.max(0,Math.min(1,Number(l.target.value)))),className:"w-24",disabled:!k})]}),h.jsxs("label",{className:"flex items-center gap-2",children:[h.jsx("input",{type:"checkbox",checked:e,onChange:l=>r(l.target.checked),className:"size-4",disabled:!k}),h.jsx("span",{className:"text-sm",children:"Chart Expected Regret"})]}),h.jsxs("label",{className:"flex items-center gap-2",children:[h.jsx("input",{type:"checkbox",checked:s,onChange:l=>u(l.target.checked),className:"size-4",disabled:!k}),h.jsx("span",{className:"text-sm",children:"Continuous"})]})]}),h.jsxs("div",{className:"flex flex-wrap items-center gap-3 justify-center",children:[h.jsx(K,{onClick:x?i:n,variant:"default",disabled:!k,children:x?"Pause":"Start"}),h.jsx(K,{onClick:t,disabled:!k,variant:"destructive",children:"Reset"})]})]})}function me({ads:k,winnerIdx:E}){return h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3",children:k.map((N,s)=>{const u=E===s;return h.jsxs("div",{className:"rounded-lg border p-3 transition-colors "+(u?"border-amber-400 bg-amber-50 text-amber-900 dark:bg-amber-100/10 dark:text-amber-200":"border-border bg-card text-card-foreground"),children:[h.jsxs("div",{className:"font-semibold mb-1",children:["Ad ",N.id+1]}),h.jsxs("div",{className:"text-sm opacity-80",children:["True CTR: ",N.trueCtr.toFixed(3)]}),h.jsxs("div",{className:"text-sm opacity-80",children:["Bid: $",N.bid.toFixed(2)]}),h.jsxs("div",{className:"text-sm",children:["Clicks: ",N.clicks]}),h.jsxs("div",{className:"text-sm",children:["Impressions: ",N.impressions]}),h.jsxs("div",{className:"text-sm",children:["Revenue: $",N.revenue.toFixed(2)]})]},N.id)})})}function de({totals:k,ads:E=[]}){return h.jsxs("div",{className:"space-y-6",children:[h.jsx("div",{className:"overflow-x-auto rounded-lg border",children:h.jsxs("table",{className:"w-full text-sm",children:[h.jsx("thead",{className:"bg-muted/60",children:h.jsxs("tr",{className:"border-b",children:[h.jsx("th",{scope:"col",className:"px-4 py-2 text-left font-semibold",children:"Metric"}),h.jsx("th",{scope:"col",className:"px-4 py-2 text-left font-semibold",children:"Value"})]})}),h.jsxs("tbody",{children:[h.jsxs("tr",{className:"border-b",children:[h.jsx("td",{className:"px-4 py-2",children:"Iterations"}),h.jsx("td",{className:"px-4 py-2",children:k.totalIterations})]}),h.jsxs("tr",{className:"border-b",children:[h.jsx("td",{className:"px-4 py-2",children:"Total Revenue"}),h.jsxs("td",{className:"px-4 py-2",children:["$",k.totalRevenue.toFixed(2)]})]}),h.jsxs("tr",{className:"border-b",children:[h.jsx("td",{className:"px-4 py-2",children:"Perfect Total Revenue"}),h.jsxs("td",{className:"px-4 py-2",children:["$",Number(k.perfectTotalRevenue||0).toFixed(2)]})]}),h.jsxs("tr",{className:"border-b",children:[h.jsx("td",{className:"px-4 py-2",children:"Realized Regret"}),h.jsxs("td",{className:"px-4 py-2",children:["$",Number(k.regret||0).toFixed(2)]})]}),h.jsxs("tr",{children:[h.jsx("td",{className:"px-4 py-2",children:"Expected Regret"}),h.jsxs("td",{className:"px-4 py-2",children:["$",Number(k.expectedRegret||0).toFixed(2)]})]})]})]})}),E.length>0&&h.jsx("div",{className:"overflow-x-auto rounded-lg border",children:h.jsxs("table",{className:"w-full text-sm",children:[h.jsx("thead",{className:"bg-muted/60",children:h.jsxs("tr",{className:"border-b",children:[h.jsx("th",{scope:"col",className:"px-4 py-2 text-left font-semibold",children:"Ad"}),h.jsx("th",{scope:"col",className:"px-4 py-2 text-left font-semibold",children:"Revenue"})]})}),h.jsx("tbody",{children:E.map(N=>h.jsxs("tr",{className:"border-b last:border-0",children:[h.jsxs("td",{className:"px-4 py-2",children:["Ad ",N.id+1]}),h.jsxs("td",{className:"px-4 py-2",children:["$",Number(N.revenue||0).toFixed(2)]})]},N.id))})]})})]})}function ve({steps:k,revenue:E,regret:N,expected:s=!0}){const u=[{x:k,y:E,type:"scatter",mode:"lines",name:"Total Revenue",line:{color:"#2ecc71"},fill:"tozeroy",fillcolor:"rgba(46, 204, 113, 0.25)"},{x:k,y:N,type:"scatter",mode:"lines",name:s?"Expected Regret":"Cumulative Regret",line:{color:"#e74c3c"},fill:"tozeroy",fillcolor:s?"rgba(231, 76, 60, 0.18)":"rgba(231, 76, 60, 0.28)"}];return h.jsx("div",{className:"w-full",children:h.jsx(j,{data:u,layout:{title:s?"Total Revenue vs Expected Regret":"Total Revenue vs Cumulative Regret",xaxis:{title:"Steps"},yaxis:{title:"Amount ($)"},margin:{t:40,r:20,b:40,l:50},showlegend:!0,hovermode:"x unified"},config:{displayModeBar:!1,responsive:!0},style:{width:"100%",height:360}})})}const pe=()=>new Worker(new URL("/assets/simulation.worker-COLzJQCe.js",import.meta.url),{type:"module"});function xe(){const k=z.useRef(null),[E,N]=z.useState(null),[s,u]=z.useState([]),[w,g]=z.useState({totalIterations:0,totalRevenue:0}),[x,v]=z.useState(3),[o,e]=z.useState(.05),[r,n]=z.useState(!0),[i,t]=z.useState("42"),[l,f]=z.useState(1),[m,d]=z.useState(!1),[c,a]=z.useState(!1),[p,y]=z.useState(!1),[b,q]=z.useState(.01),[R,_]=z.useState(!0),[P,I]=z.useState([]),[A,V]=z.useState([]),[H,W]=z.useState([]),[O,$]=z.useState([]);z.useEffect(()=>{const T=pe();return k.current=T,T.onmessage=L=>{const{type:J,payload:C}=L.data||{};if(J==="ready"){if(d(!0),C!=null&&C.ads&&u(C.ads),C!=null&&C.totals){g(C.totals);const B=C.totals.totalIterations||0,U=C.totals.totalRevenue||0,S=C.totals.regret||0,ee=C.totals.expectedRegret||0;I([B]),V([U]),W([S]),$([ee])}}else J==="tick"?(N(C),u(C.ads),g(C.totals),I(B=>[...B,C.totals.totalIterations]),V(B=>[...B,C.totals.totalRevenue]),W(B=>[...B,C.totals.regret]),$(B=>[...B,C.totals.expectedRegret||0])):J==="reset_done"&&(u([]),g({totalIterations:0,totalRevenue:0}),d(!1),I([]),V([]),W([]),$([]))},()=>{T.terminate(),k.current=null}},[]),z.useEffect(()=>{k.current&&k.current.postMessage({type:"init",payload:{numAds:x,seed:i||void 0,dynamicEnv:p}})},[x,i,p]);const G=()=>{var T;(T=k.current)==null||T.postMessage({type:"reset"}),d(!1),a(!1),I([]),V([]),W([]),setTimeout(()=>{var L;(L=k.current)==null||L.postMessage({type:"init",payload:{numAds:x,seed:i||void 0,dynamicEnv:p}})},10)},F=()=>{var T;(T=k.current)==null||T.postMessage({type:"start",payload:{continuous:r,speedSec:o,stepsPerTick:l,decay:b}}),a(!0)},Q=()=>{var T;(T=k.current)==null||T.postMessage({type:"pause"}),a(!1)};return h.jsxs("div",{className:"max-w-5xl w-full mx-auto px-4 py-6 space-y-6",children:[h.jsxs("header",{className:"text-center space-y-1",children:[h.jsx("h1",{className:"text-2xl sm:text-3xl font-bold tracking-tight",children:"Thompson Sampling React Demo"}),h.jsx("p",{className:"text-sm text-muted-foreground",children:"Dynamic multi-armed bandit simulation with Plotly charts"})]}),h.jsxs("section",{"aria-labelledby":"case-study-section",className:"p-4 border rounded-lg",children:[h.jsx("h2",{id:"case-study-section",className:"font-semibold mb-2",children:"Case Study"}),h.jsxs("div",{className:"leading-relaxed text-left text-sm space-y-3",children:[h.jsx("p",{children:"Consider an advertising platform running multiple creatives for a product launch. Early on, exploration reveals which creatives appeal to different audiences. As the campaign progresses, user interest shifts (weekend spikes, midweek dips), and advertisers adjust bids to pace budgets."}),h.jsx("p",{children:"Thompson Sampling adapts by continuously balancing exploration with exploitation in dynamic environments by sampling from each ad’s Beta prior over CTR and choosing the ad with the largest sample. Each impression produces either a click or no click, which updates the ad’s Beta parameters."}),h.jsxs("ul",{className:"list-disc pl-6 space-y-1",children:[h.jsxs("li",{children:[h.jsx("strong",{children:"Goal:"})," Maximize platform revenue (CPC × clicks) while learning CTRs."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Dynamics:"})," True CTR and bids drift seasonally and mean-revert to campaign baselines."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Policy:"})," TS selects ads by sampling CTRs from Beta posteriors; second-price auction sets CPC."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Evaluation:"})," We track realized revenue and both realized and expected regret against an oracle with perfect knowledge of CTRs."]})]})]})]}),h.jsxs("section",{"aria-labelledby":"concepts-section",className:"p-4 border rounded-lg",children:[h.jsx("h2",{id:"concepts-section",className:"font-semibold mb-2",children:"Concepts"}),h.jsxs("ul",{className:"list-disc pl-6 text-sm space-y-1 text-left",children:[h.jsxs("li",{children:[h.jsx("strong",{children:"CTR:"})," True (hidden) click probability for an ad. The demo simulates it and can make it dynamic."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Beta Prior:"})," Beta(α, β). We update α on click and β on no click; optional prior decay emphasizes recent data."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Second-Price Auction (CPC):"})," The winner pays the highest competing bid."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Revenue:"})," Added only on clicks: CPC when a click happens."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Regret:"})," Difference between oracle best expected revenue and the chosen policy’s revenue. We track both realized and expected regret."]}),h.jsxs("li",{children:[h.jsx("strong",{children:"Dynamic Environment:"})," Mean-reverting seasonal drift in CTR and bids to simulate changing markets."]})]})]}),h.jsxs("section",{"aria-labelledby":"ads-section",className:"border rounded-lg p-4",children:[h.jsx("h2",{id:"ads-section",className:"font-semibold mb-2",children:"Advertisements"}),h.jsx(ce,{numAds:x,setNumAds:v,seed:i,setSeed:t,dynamicEnv:p,setDynamicEnv:y,onInit:()=>d(!0)}),h.jsxs("div",{className:"mt-2 text-sm",children:[h.jsx("span",{className:"font-semibold mr-2",children:"Status:"}),E!=null&&E.status?h.jsx("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-xs font-semibold "+(E.status==="EXPLOIT"?"bg-emerald-500 text-white":"bg-sky-500 text-white"),children:E.status}):h.jsx("span",{className:"opacity-60",children:"—"}),typeof(E==null?void 0:E.cpcPrice)=="number"&&h.jsxs("span",{className:"ml-3",children:[h.jsx("strong",{children:"CPC:"})," $",E.cpcPrice.toFixed(2)]})]}),h.jsx("div",{className:"mt-4",children:h.jsx(me,{ads:s,winnerIdx:(E==null?void 0:E.winnerIdx)??null})})]}),h.jsxs("section",{"aria-labelledby":"sim-section",className:"border rounded-lg p-4",children:[h.jsx("h2",{id:"sim-section",className:"font-semibold mb-2",children:"Simulation"}),h.jsx(ae,{initialized:m,speedSec:o,setSpeedSec:e,continuous:r,setContinuous:n,stepsPerTick:l,setStepsPerTick:f,decay:b,setDecay:q,chartExpected:R,setChartExpected:_,running:c,onStart:F,onPause:Q,onReset:G}),h.jsx("div",{className:"my-4",children:h.jsx(fe,{ads:s})}),h.jsx("div",{className:"my-4",children:h.jsx(ve,{steps:P,revenue:A,regret:R?O:H,expected:R})})]}),h.jsxs("section",{"aria-labelledby":"report-section",className:"border rounded-lg p-4",children:[h.jsx("h2",{id:"report-section",className:"font-semibold mb-2",children:"Report"}),h.jsx(de,{totals:w,ads:s})]})]})}export{xe as default};
