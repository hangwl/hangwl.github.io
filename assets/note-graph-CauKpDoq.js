const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/react-force-graph-2d-DpkSlAtq.js","assets/index-BY1L9Kpq.js","assets/index-BTzNhcaL.css","assets/index-Chjiymov.js"])))=>i.map(i=>d[i]);
import{c as L,r as i,al as H,s as O,_ as G,j as o,B as D}from"./index-BY1L9Kpq.js";import{A as I}from"./arrow-left-DQPXR70W.js";import{a as C,F as V}from"./folder-open-CYsXXqRx.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],$=L("rotate-ccw",W);function w(x){let m=0;for(let g=0;g<x.length;g++)m=x.charCodeAt(g)+((m<<5)-m);return`hsl(${Math.abs(m)%360}, 70%, 55%)`}const U=i.memo(({data:x})=>{const m=H(),k=i.useRef(null),[g,E]=i.useState({width:0,height:0}),{resolvedTheme:P}=O(),j=P==="dark",[v,T]=i.useState(null),[c,R]=i.useState(null),[S,_]=i.useState(null),p=i.useRef(null);i.useEffect(()=>{G(()=>import("./react-force-graph-2d-DpkSlAtq.js"),__vite__mapDeps([0,1,2,3])).then(n=>{_(()=>n.default)})},[]),i.useEffect(()=>{if(k.current){const n=new ResizeObserver(e=>{const r=e[0];if(!r)return;const{width:t,height:d}=r.contentRect;E({width:t,height:d})});return n.observe(k.current),()=>n.disconnect()}},[]);const F=i.useMemo(()=>j?{note:"#e2e8f0",noteHover:"#60a5fa",text:"#cbd5e1",link:"rgba(226, 232, 240, 0.25)"}:{note:"#334155",noteHover:"#3b82f6",text:"#475569",link:"rgba(45, 55, 72, 0.2)"},[j]),A=i.useMemo(()=>{if(c===null)return{nodes:x.folders.map(e=>({id:e.name,title:e.name.toUpperCase(),type:"folder",noteCount:e.noteCount,color:w(e.name)})),links:[]};{const n=c.split("/"),e=x.folders.find(s=>s.name===n[0]);if(!e)return{nodes:[],links:[]};const r=e.notes,t=c+"/",d=new Set,h=[];r.forEach(s=>{if(!s.id.startsWith(t)&&s.id.split("/").slice(0,n.length).join("/")!==c)return;const l=s.id.split("/"),a=n.length;if(l.length===a+1)h.push({id:s.id,title:s.title,type:"note",color:w(s.id)});else if(l.length>a+1){const N=l.slice(0,a+1).join("/");d.add(N)}});const b=[...Array.from(d).map(s=>{const l=s.split("/").pop()||s,a=r.filter(N=>N.id.startsWith(s+"/")||N.id.startsWith(s)).length;return{id:s,title:l.replace(/-/g," ").toUpperCase(),type:"folder",noteCount:a,color:w(s)}}).sort((s,l)=>s.title.localeCompare(l.title)),...h.sort((s,l)=>s.title.localeCompare(l.title))],u=new Set(h.map(s=>s.id)),y=[];return r.forEach(s=>{var l;u.has(s.id)&&((l=s.links)==null||l.forEach(a=>{u.has(a)&&y.push({source:s.id,target:a})}))}),{nodes:b,links:y}}},[x,c]),z=i.useCallback(n=>{const e=n;e.type==="folder"?R(e.id):m({to:`/notes/${e.id}`})},[m]),M=i.useCallback(()=>{R(null)},[]),B=i.useCallback(()=>{p.current&&p.current.zoomToFit(400,50)},[]);return i.useEffect(()=>{var n,e;p.current&&((n=p.current.d3Force("charge"))==null||n.strength(-50),(e=p.current.d3Force("link"))==null||e.distance(200),setTimeout(()=>{var r;(r=p.current)==null||r.zoomToFit(400,50)},500))},[A]),o.jsxs("div",{className:"flex flex-col h-full",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-4 shrink-0",children:[c?o.jsxs(o.Fragment,{children:[o.jsxs(D,{variant:"ghost",size:"sm",onClick:M,children:[o.jsx(I,{className:"w-4 h-4 mr-1"}),"Back"]}),o.jsx("span",{className:"text-muted-foreground",children:"/"}),o.jsxs("span",{className:"font-medium flex items-center gap-1",children:[o.jsx(C,{className:"w-4 h-4"}),(c.split("/").pop()||c).toUpperCase()]})]}):o.jsxs("span",{className:"font-medium flex items-center gap-1",children:[o.jsx(C,{className:"w-4 h-4"}),"NOTES"]}),o.jsx("div",{className:"flex-1"}),o.jsxs(D,{variant:"outline",size:"sm",onClick:B,children:[o.jsx($,{className:"w-4 h-4 mr-1"}),"Reset View"]})]}),o.jsx("div",{ref:k,className:"flex-1 min-h-0 rounded-lg border border-border/40 backdrop-blur-md bg-background/80 dark:bg-black/20",children:S?o.jsx(S,{ref:p,width:g.width,height:g.height,graphData:A,onNodeHover:n=>T(n),nodeCanvasObject:(n,e,r)=>{const t=n;if(t.x===void 0||t.y===void 0)return;const d=t.title||t.id,h=(v==null?void 0:v.id)===t.id,f=t.type==="folder",b=f?14:8,u=h?b*1.2:b,y=t.color||"#3b82f6";if(e.beginPath(),f){const l=u*1.8,a=t.x-l/2,N=t.y-l/2;e.roundRect(a,N,l,l,3)}else e.arc(t.x,t.y,u,0,2*Math.PI);e.fillStyle=y,e.fill(),f&&(e.fillStyle=j?"#1e293b":"#ffffff",e.font=`bold ${u*.9}px Sans-Serif`,e.textAlign="center",e.textBaseline="middle",e.fillText(String(t.noteCount||0),t.x,t.y));const s=12/r;e.font=`${s}px Sans-Serif`,e.textAlign="center",e.textBaseline="top",e.fillStyle=F.text,e.fillText(d,t.x,t.y+u+4)},nodePointerAreaPaint:(n,e,r)=>{const t=n;if(t.x===void 0||t.y===void 0)return;const d=t.type==="folder",h=d?14:8;if(r.fillStyle=e,r.beginPath(),d){const f=h*1.8,b=t.x-f/2,u=t.y-f/2;r.fillRect(b,u,f,f)}else r.arc(t.x,t.y,h,0,2*Math.PI),r.fill()},onNodeClick:z,linkColor:()=>F.link,linkWidth:1.5,linkDirectionalArrowLength:6,linkDirectionalArrowRelPos:1,nodeRelSize:8,enableNodeDrag:!0,cooldownTicks:100,d3AlphaDecay:.02,d3VelocityDecay:.3}):o.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Loading graph..."})}),o.jsx("div",{className:"flex items-center justify-center gap-6 mt-4 text-sm text-muted-foreground shrink-0",children:c===null?o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(C,{className:"w-4 h-4 text-blue-500"}),"Click a folder to explore notes"]}):o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(V,{className:"w-4 h-4"}),"Click a note to read"]})})]})});U.displayName="NoteGraph";export{U as default};
